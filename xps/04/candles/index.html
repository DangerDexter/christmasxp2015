<!DOCTYPE html>
<html lang="en">
    <!--
           *             ,
                       _/^\_
                      <     >
     *                 /.-.\         *
              *        `/&\`                   *
                      ,@.*;@,
                     /_o.I %_\    *
        *           (`'--:o(_@;
                   /`;--.,__ `')             *
                  ;@`o % O,*`'`&\
            *    (`'--)_@ ;o %'()\      *
                 /`;--._`''--._O'@;
                /&*,()~o`;-.,_ `""`)
     *          /`,@ ;+& () o*`;-';\
               (`""--.,_0 +% @' &()\
               /-.,_    ``''--....-'`)  *
          *    /@%;o`:;'--,.__   __.'\
              ;*,&(); @ % &^;~`"`o;@();         *
              /(); o^~; & ().o@*&`;&%O\
        jgs   `"="==""==,,,.,="=="==="`
           __.----.(\-''#####---...___...-----._
         '`         \)_`"""""`
                 .--' ')
               o(  )_-\
                 `"""` `
	   MERRY CHRISTMAS!
    -->
    <head>
        <title>TITLE</title>
        <meta charset="utf-8">
        <meta name="author" content="AUTHOR">
        <meta name="description" content="DESCRIPTION">
        <meta property="og:title" content="TITLE"/>
        <meta property="og:type" content="website"/>
        <meta property="og:url" content="URL"/>
        <meta property="og:image" content="FACEBOOK_IMG"/>
        <meta property="og:site_name" content="WEBSITE"/>
        <meta property="og:description" content="DESCRIPTION"/>
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, minimum-scale=1, maximum-scale=1">
<link href='https://fonts.googleapis.com/css?family=Dancing+Script' rel='stylesheet' type='text/css'>
<style>body,html{margin:0;padding:0;overflow:hidden;position:absolute;left:0;top:0;width:100%;height:100%}h1,h2{position:absolute;width:100%;text-align:center;font-family:'Dancing Script';font-weight:400;pointer-events:none;z-index:1;transition:1s .5s}h2{transition-delay:.8s}h1{font-size:48px;top:20px;left:0}h2{top:120px;left:0}canvas{position:absolute;left:0;top:0;cursor:none}.lit canvas{cursor:default}.hidden{opacity:0!important;transform:translateY(10px)!important;transition:.5s!important}#good-deed{position:absolute;font-family:'Dancing Script';outline:0;-webkit-outline:0;text-align:center;display:block;left:50%;top:180px;width:320px;margin-left:-160px;font-size:32px;background:0 0;border:0;border-bottom:1px solid #000;border-radius:0;padding:8px;opacity:0;pointer-events:none;z-index:1;transform:translateY(10px);transition:1s 1.6s}.lit #good-deed{pointer-events:all;opacity:1;transform:translateY(0px)}#tweet{position:absolute;left:50%;top:120px;margin-left:-15px;width:30px;height:30px;z-index:1;opacity:1;background:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4wLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4yIiBiYXNlUHJvZmlsZT0idGlueSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiDQoJIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgNDA1IDQwNSIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8cGF0aCBmaWxsPSIjMjkyRjMzIiBkPSJNMzQwLjcsMTE1LjJjLTEwLjEsNC41LTIwLjksNy41LTMyLjIsOC44YzExLjYtNi45LDIwLjUtMTcuOSwyNC43LTMxYy0xMC44LDYuNC0yMi44LDExLjEtMzUuNiwxMy42DQoJYy0xMC4yLTEwLjktMjQuOC0xNy43LTQwLjktMTcuN2MtMzEsMC01Ni4xLDI1LjEtNTYuMSw1Ni4xYzAsNC40LDAuNSw4LjcsMS41LDEyLjhjLTQ2LjYtMi4zLTg3LjktMjQuNy0xMTUuNi01OC42DQoJYy00LjgsOC4zLTcuNiwxNy45LTcuNiwyOC4yYzAsMTkuNSw5LjksMzYuNiwyNSw0Ni43Yy05LjItMC4zLTE3LjgtMi44LTI1LjQtN2MwLDAuMiwwLDAuNSwwLDAuN2MwLDI3LjIsMTkuMyw0OS44LDQ1LDU1DQoJYy00LjcsMS4zLTkuNywyLTE0LjgsMmMtMy42LDAtNy4xLTAuNC0xMC42LTFjNy4xLDIyLjMsMjcuOSwzOC41LDUyLjQsMzljLTE5LjIsMTUtNDMuNCwyNC02OS43LDI0Yy00LjUsMC05LTAuMy0xMy40LTAuOA0KCWMyNC44LDE1LjksNTQuMywyNS4yLDg2LDI1LjJjMTAzLjIsMCwxNTkuNi04NS41LDE1OS42LTE1OS42YzAtMi40LTAuMS00LjktMC4yLTcuM0MzMjMuNywxMzYuNCwzMzMuMiwxMjYuNSwzNDAuNywxMTUuMnoiLz4NCjwvc3ZnPg0K) 0 0/100% 100% no-repeat;cursor:pointer;transition:1s 1.5s}</style>
</head><body>
<h1 class="hidden">Light a candle</h1>
<h2 class="hidden">What was your good deed today?</h2>
<form id="good-deed-form">
<input id="good-deed" autocomplete="off"></input>
</form>
<div id="tweet" class="hidden"></div>
<h1 class="hidden" id="well-done">Well done</h1><script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r73/three.min.js"></script>
<script>var skyMaterial=new THREE.RawShaderMaterial({uniforms:{iResolution:{type:"v3",value:new THREE.Vector3},iGlobalTime:{type:"f",value:0}},vertexShader:["precision highp float;","attribute vec3 position;","void main() {","	gl_Position = vec4(position, 1.0);","}"].join("\n"),fragmentShader:["precision highp float;","precision lowp int;","uniform vec3      iResolution;","uniform float     iGlobalTime;","vec3 shadeBg(vec3 nml, vec2 fragCoord)","{","	vec3 lightPos_ = vec3(","		0.0, ","		4.0, ","		0.0","	);","	vec3 bgLight = normalize(lightPos_);","	vec3 lightPos = bgLight * 9999.0;","	vec3 sun = vec3(4.0, 3.5, 2.0)*4.0;","	vec2 aspect = vec2(iResolution.x/iResolution.y, 1.0);","	vec2 uv = (2.0 * fragCoord.xy / iResolution.xy - 1.0) * aspect;","	vec3 bgColz = vec3(0.5, 0.3, 0.15);","	float bgDiff = dot(nml, vec3(0.0, -1.0, 0.0));","	float sunPow = dot(nml, bgLight);","	float sp = max(sunPow, 0.0);","	vec3 bgCol = vec3(0.5, 0.6, 0.8)*0.7;","	bgCol += max(0.0, bgDiff)*vec3(0.5, 0.50, 1.1)*0.7;","	bgCol += nml.y*nml.y*vec3(0.5, 0.2, 0.4);","	bgCol += max(0.0, -bgDiff)*vec3(0.4, 0.2, 0.3);","	bgCol += vec3(0.8, 0.5, 0.35)*( pow(1.0-abs(bgDiff), 16.0)*(0.2*dot(uv,uv)) );","	return bgCol;","}","void main(void)","{","	vec2 aspect = vec2(iResolution.x/iResolution.y, 1.0);","	vec2 uv = gl_FragCoord.xy / iResolution.xy;","	uv = (2.0 * uv - 1.0) * aspect;","   uv.y += 0.35;","	vec3 light = shadeBg(-normalize(vec3(uv, 1.0)), gl_FragCoord.xy);","	gl_FragColor = vec4( 1.0 - exp(-1.5 * light), 1.0 );","}"].join("\n"),depthWrite:false});var Sky=function(){var skyPlane=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),skyMaterial);skyPlane.ontick=function(t){this.material.uniforms.iGlobalTime.value=t/1e3;this.material.uniforms.iResolution.value.set(window.innerWidth,window.innerHeight,0)};return skyPlane};</script>
<script>if(typeof loadCount==="undefined"){loadCount=0}loadCount+=2;var matchboxTopTexture=(new THREE.TextureLoader).load("match_top_tex.jpg",function(){loadCount--});matchboxTopTexture.anisotropy=16;var matchboxSideTexture=(new THREE.TextureLoader).load("match_side_tex.png",function(){loadCount--});matchboxSideTexture.anisotropy=16;var Matchbox=function(){var box=new THREE.Mesh(new THREE.BoxGeometry(1.5*3,2*3,.5*3),new THREE.MeshLambertMaterial({map:matchboxTopTexture}));var side=new THREE.Mesh(new THREE.PlaneBufferGeometry(2*3,.5*3),new THREE.MeshLambertMaterial({map:matchboxSideTexture}));side.material.side=THREE.DoubleSide;side.rotation.x=-Math.PI/2;side.rotation.y=Math.PI/2;side.position.x=1.51*3/2;box.add(side);var side2=side.clone();side2.position.x*=-1;box.add(side2);var side3=new THREE.Mesh(new THREE.PlaneBufferGeometry(1.5*3,.5*3),new THREE.MeshLambertMaterial({color:16777215}));side3.material.side=THREE.DoubleSide;side3.position.y=1.01*3;side3.rotation.x=-Math.PI/2;box.add(side3);var side4=side3.clone();side4.position.y*=-1;box.add(side4);return box};var Matchstick=function(){var stick=new THREE.Mesh(new THREE.BoxGeometry(.075*3,1.8*3,.075*3),new THREE.MeshLambertMaterial({color:8943445}));var blob=new THREE.Mesh(new THREE.SphereGeometry(.07*3,8,8),new THREE.MeshLambertMaterial({color:4469521}));blob.scale.set(1,2,1);blob.position.y=1.8/2*3;stick.blob=blob;stick.add(blob);return stick};</script>
<script>if(typeof loadCount==="undefined"){loadCount=0}loadCount+=3;var candleFlareTexture=(new THREE.TextureLoader).load("candle_flare.jpg",function(){loadCount--});var candleFlare2Texture=(new THREE.TextureLoader).load("flare2.jpg",function(){loadCount--});var candleMegaFlareTexture=(new THREE.TextureLoader).load("candle_mega_flare.jpg",function(){loadCount--});var Flame=function(megaFlare){var rFlame=.5;var flameGeo=new THREE.Geometry;for(var i=0,j=0,k=0;i<4;i++){var a0=i/4*Math.PI*2;var a1=(i+1)/4*Math.PI*2;var x0=Math.cos(a0);var z0=Math.sin(a0);var x1=Math.cos(a1);var z1=Math.sin(a1);flameGeo.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(rFlame*x0,.9,rFlame*z0),new THREE.Vector3(rFlame*x1,.9,rFlame*z1));flameGeo.vertices.push(new THREE.Vector3(rFlame*x0,.9,rFlame*z0),new THREE.Vector3(0,3,0),new THREE.Vector3(rFlame*x1,.9,rFlame*z1));flameGeo.faces.push(new THREE.Face3(k++,k++,k++));flameGeo.faces.push(new THREE.Face3(k++,k++,k++))}flameGeo.mergeVertices();var flame=new THREE.Mesh(flameGeo,new THREE.MeshBasicMaterial({color:16775406,opacity:1,transparent:true,fog:false}));for(var i=0;i<flameGeo.vertices.length;i++){var v=flameGeo.vertices[i];v.o=v.clone()}flame.ontick=function(t){for(var i=this.previousPositions.length-2;i>=0;i--){this.previousPositions[i+1].copy(this.previousPositions[i])}this.previousPositions[0].copy(this.position);var verts=this.geometry.vertices;for(var i=0;i<verts.length;i++){var v=verts[i];if(v.x!==0||v.y!==0||v.z!==0){var frame=Math.floor((this.previousPositions.length-1)*(v.o.y/3));this.velocity.subVectors(this.position,this.previousPositions[frame]);v.x=-this.velocity.x+v.o.x+(Math.random()-.5)*.1;v.y=-this.velocity.y+v.o.y+(Math.random()-.5)*.1}}this.geometry.verticesNeedUpdate=true};flame.previousPositions=[];for(var i=0;i<3;i++){flame.previousPositions[i]=flame.position.clone()}flame.velocity=new THREE.Vector3;var flare=new THREE.Mesh(new THREE.PlaneGeometry(15,15),new THREE.MeshBasicMaterial({color:16775406,map:candleFlareTexture,opacity:.3,transparent:true,fog:false,depthWrite:false,depthTest:false,blending:THREE.AdditiveBlending}));flare.position.y+=1.5;flare.originalPosition=flare.position.clone();flame.add(flare);flare.ontick=function(){this.position.x=this.originalPosition.x+(Math.random()-.5)*.1;this.position.y=this.originalPosition.y+(Math.random()-.5)*.1};flame.flare=flare;if(megaFlare){var flare2=new THREE.Mesh(new THREE.PlaneGeometry(15,15),new THREE.MeshBasicMaterial({color:16775406,map:candleFlare2Texture,opacity:.2,transparent:true,fog:false,depthWrite:false,depthTest:false,blending:THREE.AdditiveBlending}));flare2.position.y+=3;flare2.originalPosition=flare2.position.clone();flame.flare2=flare2;flare2.ontick=function(){this.position.copy(this.parent.flare.position);this.position.sub(this.parent.flare.originalPosition);this.position.multiplyScalar(-1);this.position.add(this.parent.flare.originalPosition)};flame.add(flare2);var mFlare=new THREE.Mesh(new THREE.PlaneGeometry(30,30),new THREE.MeshBasicMaterial({color:16775406,map:candleMegaFlareTexture,opacity:.6,transparent:true,fog:false,depthWrite:false,depthTest:false,blending:THREE.AdditiveBlending}));mFlare.position.y+=1.5;mFlare.originalPosition=mFlare.position.clone();mFlare.ontick=function(){this.position.copy(this.parent.flare.position)};flame.add(mFlare);flame.megaFlare=mFlare}return flame};var Candle=function(height,megaFlare){var r=.5;var y0=0;var y2=height||5+Math.random()*10;var y1=y2-0;var geo=new THREE.Geometry;for(var i=0,j=0,k=0;i<4;i++){var a0=i/4*Math.PI*2;var a1=(i+1)/4*Math.PI*2;var x0=Math.cos(a0);var z0=Math.sin(a0);var x1=Math.cos(a1);var z1=Math.sin(a1);geo.vertices.push(new THREE.Vector3(r*x0,y0,r*z0),new THREE.Vector3(r*x0,y1,r*z0),new THREE.Vector3(r*x1,y0,r*z1));geo.vertices.push(new THREE.Vector3(r*x1,y0,r*z1),new THREE.Vector3(r*x0,y1,r*z0),new THREE.Vector3(r*x1,y1,r*z1));geo.vertices.push(new THREE.Vector3(r*x0,y1,r*z0),new THREE.Vector3(0,y2,0),new THREE.Vector3(r*x1,y1,r*z1));geo.faces.push(new THREE.Face3(j++,j++,j++));geo.faces.push(new THREE.Face3(j++,j++,j++));geo.faces.push(new THREE.Face3(j++,j++,j++))}geo.mergeVertices();var wick=new THREE.Mesh(new THREE.BoxGeometry(.1,1,.1),new THREE.MeshBasicMaterial({color:0}));var candle=new THREE.Mesh(geo,new THREE.MeshBasicMaterial({color:16777198}));var obj=new THREE.Object3D;obj.add(candle);wick.position.y=y2+.4;obj.add(wick);var flame=Flame(megaFlare);flame.position.y=y2+.4;obj.add(flame);obj.flame=flame;obj.wick=wick;obj.candle=candle;return obj};</script>
<script>THREE.Object3D.prototype.tick=function(t){if(this.ontick){this.ontick(t)}for(var i=0;i<this.children.length;i++){if(this.children[i].tick){this.children[i].tick(t)}}};var init=function(){var renderer=new THREE.WebGLRenderer({antialias:true});renderer.setPixelRatio(window.devicePixelRatio||1);renderer.setSize(window.innerWidth,window.innerHeight);document.body.appendChild(renderer.domElement);renderer.setClearColor(8952234,1);var intersectPoint=new THREE.Vector3;var flamePlane=new THREE.Mesh(new THREE.PlaneBufferGeometry(2e3,2e3),new THREE.MeshBasicMaterial({color:16711935}));window.onresize=function(){renderer.setSize(window.innerWidth,window.innerHeight);camera.aspect=window.innerWidth/window.innerHeight;camera.updateProjectionMatrix()};renderer.domElement.onmousemove=function(ev){if(ev.preventDefault){ev.preventDefault()}var pointer3D=new THREE.Vector3((ev.clientX-20)/window.innerWidth*2-1,-((ev.clientY-40)/window.innerHeight)*2+1,.5);camera.position.x=pointer3D.x;camera.position.y=12+pointer3D.y;pointer3D.unproject(camera);pointer3D.sub(camera.position);pointer3D.normalize();var raycaster=new THREE.Raycaster(camera.position,pointer3D);var intersects=raycaster.intersectObjects([flamePlane]);if(intersects.length>0){intersectPoint=intersects[0].point}var matchboxIntersects=raycaster.intersectObjects([matchbox]);if(matchboxIntersects.length>0){previousX=previousX===null?pointer3D.x:previousX;previousY=previousY===null?pointer3D.y:previousY;var dx=pointer3D.x-previousX;var dy=pointer3D.y-previousY;var d=Math.sqrt(dx*dx+dy*dy);scratchHeat+=d;if(scratchHeat>.05){lightMatch()}previousX=pointer3D.x;previousY=pointer3D.y;return true}previousX=pointer3D.x;previousY=pointer3D.y;return false};var mousedown=false;var scratching=false;var previousX=0,previousY=0;var scratchHeat=0;renderer.domElement.onmousedown=function(ev){previousX=null;previousY=null;mousedown=true;if(!matchLit){scratching=true}};window.onmouseup=function(ev){mousedown=false;scratching=false;scratchHeat=0};var ongoingTouches={};var activeTouch=null;renderer.domElement.addEventListener("touchstart",function(ev){var touches=ev.changedTouches;for(var i=0;i<touches.length;i++){ongoingTouches[touches[i].identifier]=touches[i]}if(activeTouch===null){renderer.domElement.onmousedown(touches[0]);activeTouch=touches[0].identifier}ev.preventDefault()},false);renderer.domElement.addEventListener("touchend",function(ev){var touches=ev.changedTouches;for(var i=0;i<touches.length;i++){delete ongoingTouches[touches[i].identifier];if(touches[i].identifier===activeTouch){window.onmouseup(touches[i]);activeTouch=null}}ev.preventDefault()},false);renderer.domElement.addEventListener("touchcancel",function(ev){var touches=ev.changedTouches;for(var i=0;i<touches.length;i++){delete ongoingTouches[touches[i].identifier];if(touches[i].identifier===activeTouch){window.onmouseup(touches[i]);activeTouch=null}}ev.preventDefault()},false);renderer.domElement.addEventListener("touchmove",function(ev){var touches=ev.changedTouches;for(var i=0;i<touches.length;i++){delete ongoingTouches[touches[i].identifier];if(touches[i].identifier===activeTouch){renderer.domElement.onmousemove(touches[i])}}ev.preventDefault()},false);document.getElementById("good-deed").oninput=function(ev){if(this.value!==""){document.body.classList.add("filled")}else{document.body.classList.remove("filled")}};document.getElementById("good-deed").onkeydown=function(ev){if(ev.keyCode===13){recordDeed()}};document.getElementById("good-deed-form").onsubmit=function(ev){ev.preventDefault()};document.getElementById("tweet").onclick=function(ev){share();ev.preventDefault()};var shareText="";var recordDeed=function(){window.scrollTo(0,0);shareText=document.getElementById("good-deed").value;document.querySelector("h1").classList.add("hidden");document.querySelector("h2").classList.add("hidden");document.querySelector("#good-deed").classList.add("hidden");document.querySelector("#tweet").classList.remove("hidden");document.getElementById("good-deed-form").blur();setTimeout(function(){document.getElementById("good-deed-form").remove()},500);document.getElementById("well-done").classList.remove("hidden")};window.scrollTo(0,0);var share=function(){var share_url="https://twitter.com/intent/tweet?text="+encodeURIComponent(shareText)+"&hashtags="+encodeURIComponent("LightACandle")+"&url=";share_url+=encodeURIComponent(document.location.toString());window.open(share_url,"Share this","width=500,height=350")};var flameOff=function(flame){flame.material.opacity=0;flame.flare.material.opacity=0;flame.flare2.material.opacity=0;flame.megaFlare.material.opacity=0};var flameOn=function(flame){flame.material.opacity=.7;flame.flare.material.opacity=.3;flame.flare2.material.opacity=.15;flame.megaFlare.material.opacity=.5};var flameLight=new THREE.PointLight;var lightMatch=function(){matchstick.blob.scale.multiplyScalar(.8);matchstick.blob.material.color.setHex(0);flameOn(match.flame);scene.add(flameLight);match.flame.add(flameLight);flameLight.position.y=.5;matchLit=true};var lightCandle=function(){flameOn(newCandle.flame);flameOff(match.flame);document.querySelector("h2").classList.remove("hidden");lit=true;newCandle.flame.add(flameLight);document.body.className="lit";document.getElementById("good-deed").focus()};var lit=false;var matchLit=false;var scene=new THREE.Scene;scene.fog=new THREE.Fog(8952268,45,160);var camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,400);camera.position.z=40;camera.position.y=12;scene.add(camera);var sky=Sky();sky.position.z=0;scene.add(sky);var newCandle=Candle(22,true);newCandle.position.y=-10;newCandle.flame.material.opacity=0;newCandle.flame.flare.material.opacity=0;newCandle.flame.flare2.material.opacity=0;newCandle.flame.megaFlare.material.opacity=0;scene.add(newCandle);var candles=new THREE.Object3D;var candleCount=0;var candleParts=["candle","wick"];scene.add(candles);candles.position.y=-15;var emptyCandle=Candle();delete emptyCandle.flame.ontick;emptyCandle.remove(emptyCandle.flame);for(var i=0;i<candleParts.length;i++){var partName=candleParts[i];emptyCandle[partName].geometry=new THREE.Geometry;emptyCandle[partName].position.set(0,0,0)}candles.add(emptyCandle);var index={};for(var idx=0;idx<20*3;idx++){candleCount++;do{var x=Math.floor(Math.random()*21)-10;var z=1+2*Math.floor(Math.random()*3)}while(index[x+":"+z]);index[x+":"+z]=true;if(x!==0){var c=Candle();c.position.x=9*(x+.8*(Math.random()-.5));c.position.z=-12-5*(z+.8*(Math.random()-.5));c.rotation.z=.125*Math.pow((Math.random()-.5)*2,3);c.flame.rotation.z=-c.rotation.z;candles.add(c);c.updateMatrixWorld();c.updateMatrix();for(var i=0;i<candleParts.length;i++){var partName=candleParts[i];var part=c[partName];part.updateMatrixWorld();var otherPartGeo=emptyCandle[partName].geometry;otherPartGeo.merge(part.geometry,part.matrixWorld);otherPartGeo.verticesNeedUpdate=true;otherPartGeo.elementsNeedUpdate=true;delete otherPartGeo.__directGeometry;c.remove(part)}}}var matchbox=Matchbox();matchbox.position.set(-10,13,-5);matchbox.rotation.set(-1.1,-.3,Math.PI+2.4);matchbox.velocity=new THREE.Vector3(-.3,.5,-.1);matchbox.introVelocity=new THREE.Vector3;matchbox.introRVelocity=new THREE.Vector3;matchbox.originalPosition=matchbox.position.clone();matchbox.originalRotation=matchbox.rotation.clone();matchbox.position.set(8,-20,20);matchbox.rotation.set(0,3,0);scene.add(matchbox);var spring=function(velocity,target,position,stiffness){velocity.x+=(target.x-position.x)*stiffness;velocity.y+=(target.y-position.y)*stiffness;velocity.z+=(target.z-position.z)*stiffness};matchbox.ontick=function(){if(!matchLit){spring(this.introVelocity,this.originalPosition,this.position,.03);this.position.add(this.introVelocity);this.introVelocity.multiplyScalar(.9);spring(this.introRVelocity,this.originalRotation,this.rotation,.03);this.introRVelocity.add.call(this.rotation,this.introRVelocity);this.introRVelocity.multiplyScalar(.9)}if(matchLit){this.rotation.x+=0;this.rotation.y+=.2;this.rotation.z-=0;this.position.add(this.velocity);this.velocity.y-=.02;return}};var match=new THREE.Object3D;match.flame=Flame(true);match.flame.material.opacity=0;match.flame.flare.material.opacity=0;match.flame.flare2.material.opacity=0;match.flame.megaFlare.material.opacity=0;scene.add(match.flame);var matchstick=Matchstick();matchstick.position.y=-1.8/2*3;match.add(matchstick);match.position.copy(matchbox.position);match.position.x-=.2;match.position.y-=4.5;match.position.z+=5;match.rotation.set(1,1,.2);match.velocity=new THREE.Vector3(.3,.5,.1);match.flameOffset=new THREE.Vector3;window.match=match;match.ontick=function(){if(lit){matchstick.rotation.x+=0;matchstick.rotation.y+=0;matchstick.rotation.z-=.2;this.position.add(this.velocity);this.velocity.y-=.02;return}this.position.copy(intersectPoint);this.flame.position.copy(intersectPoint);this.flame.position.add(this.flameOffset);if(lit||!matchLit){return}if(matchLit){this.flame.position.y+=10;if(this.flame.position.distanceTo(newCandle.wick.position)<1){lightCandle()}this.flame.position.y-=10}};scene.add(match);var light=new THREE.PointLight;light.position.set(-20,80,20);scene.add(light);var light=new THREE.PointLight;light.position.set(20,-80,20);scene.add(light);var time=0;var tick=function(){scene.tick(time);time+=16;renderer.render(scene,camera);requestAnimationFrame(tick)};tick();document.querySelector("h1").classList.remove("hidden")};var loaderInterval=setInterval(function(){if(loadCount===0){clearInterval(loaderInterval);init()}},50);</script>
</body></html>
