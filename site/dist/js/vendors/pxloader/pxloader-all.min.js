function PxLoaderImage(t,n,e,o){var i=this,r=null;this.img=new Image,void 0!==o&&(this.img.crossOrigin=o),this.tags=n,this.priority=e;var a=function(){"complete"===i.img.readyState&&(d(),r.onLoad(i))},s=function(){d(),r.onLoad(i)},u=function(){d(),r.onError(i)},d=function(){i.unbind("load",s),i.unbind("readystatechange",a),i.unbind("error",u)};this.start=function(n){r=n,i.bind("load",s),i.bind("readystatechange",a),i.bind("error",u),i.img.src=t},this.checkStatus=function(){i.img.complete&&(d(),r.onLoad(i))},this.onTimeout=function(){d(),i.img.complete?r.onLoad(i):r.onTimeout(i)},this.getName=function(){return t},this.bind=function(t,n){i.img.addEventListener?i.img.addEventListener(t,n,!1):i.img.attachEvent&&i.img.attachEvent("on"+t,n)},this.unbind=function(t,n){i.img.removeEventListener?i.img.removeEventListener(t,n,!1):i.img.detachEvent&&i.img.detachEvent("on"+t,n)}}function PxLoaderSound(t,n,e,o){var i=this,r=null,a=navigator.userAgent.match(/(ipad|iphone|ipod)/i),s=navigator.userAgent.match(/android/i);this.useGlobalHTML5Audio=a||s,this.tags=e,this.priority=o,this.sound=soundManager.createSound({id:t,url:n,autoLoad:!1,onload:function(){r.onLoad(i)},onsuspend:function(){r.onTimeout(i)},whileloading:function(){var t=this.bytesLoaded,n=this.bytesTotal;t>0&&t===n&&r.onLoad(i)}}),this.start=function(t){r=t,this.useGlobalHTML5Audio?r.onTimeout(i):this.sound.load()},this.checkStatus=function(){switch(i.sound.readyState){case 0:break;case 1:break;case 2:r.onError(i);break;case 3:r.onLoad(i)}},this.onTimeout=function(){r.onTimeout(i)},this.getName=function(){return n}}function PxLoaderVideo(t,n,e,o){var i=this,r=null;this.readyEventName="canplaythrough";try{this.vid=new Video}catch(a){this.vid=document.createElement("video")}void 0!==o&&(this.vid.crossOrigin=o),this.tags=n,this.priority=e;var s=function(){4===i.vid.readyState&&(c(),r.onLoad(i))},u=function(){c(),r.onLoad(i)},d=function(){c(),r.onError(i)},c=function(){i.unbind("load",u),i.unbind(i.readyEventName,s),i.unbind("error",d)};this.start=function(n){r=n,i.bind("load",u),i.bind(i.readyEventName,s),i.bind("error",d),i.bind("suspend",u),i.vid.src=t,i.vid.load()},this.checkStatus=function(){4===i.vid.readyState&&(c(),r.onLoad(i))},this.onTimeout=function(){c(),4!==i.vid.readyState?r.onLoad(i):r.onTimeout(i)},this.getName=function(){return t},this.bind=function(t,n){i.vid.addEventListener?i.vid.addEventListener(t,n,!1):i.vid.attachEvent&&i.vid.attachEvent("on"+t,n)},this.unbind=function(t,n){i.vid.removeEventListener?i.vid.removeEventListener(t,n,!1):i.vid.detachEvent&&i.vid.detachEvent("on"+t,n)}}!function(t){function n(t){t=t||{},this.settings=t,null==t.statusInterval&&(t.statusInterval=5e3),null==t.loggingDelay&&(t.loggingDelay=2e4),null==t.noProgressTimeout&&(t.noProgressTimeout=1/0);var n,o=[],i=[],r=Date.now(),a={QUEUED:0,WAITING:1,LOADED:2,ERROR:3,TIMEOUT:4},s=function(t){return null==t?[]:Array.isArray(t)?t:[t]};this.add=function(t){t.tags=new e(t.tags),null==t.priority&&(t.priority=1/0),o.push({resource:t,status:a.QUEUED})},this.addProgressListener=function(t,n){i.push({callback:t,tags:new e(n)})},this.addCompletionListener=function(t,n){i.push({tags:new e(n),callback:function(n){n.completedCount===n.totalCount&&t(n)}})};var u=function(t){t=s(t);var n=function(n){for(var e=n.resource,o=1/0,i=0;i<e.tags.length;i++)for(var r=0;r<Math.min(t.length,o)&&!(e.tags.all[i]===t[r]&&o>r&&(o=r,0===o))&&0!==o;r++);return o};return function(t,e){var o=n(t),i=n(e);return i>o?-1:o>i?1:t.priority<e.priority?-1:t.priority>e.priority?1:0}};this.start=function(t){n=Date.now();var e=u(t);o.sort(e);for(var i=0,r=o.length;r>i;i++){var s=o[i];s.status=a.WAITING,s.resource.start(this)}setTimeout(d,100)};var d=function(){for(var n=!1,e=Date.now()-r,i=e>=t.noProgressTimeout,s=e>=t.loggingDelay,u=0,c=o.length;c>u;u++){var h=o[u];h.status===a.WAITING&&(h.resource.checkStatus&&h.resource.checkStatus(),h.status===a.WAITING&&(i?h.resource.onTimeout():n=!0))}s&&n&&l(),n&&setTimeout(d,t.statusInterval)};this.isBusy=function(){for(var t=0,n=o.length;n>t;t++)if(o[t].status===a.QUEUED||o[t].status===a.WAITING)return!0;return!1};var c=function(t,n){var e,s,u,d,c,l=null;for(e=0,s=o.length;s>e;e++)if(o[e].resource===t){l=o[e];break}if(null!=l&&l.status===a.WAITING)for(l.status=n,r=Date.now(),u=t.tags.length,e=0,s=i.length;s>e;e++)d=i[e],c=0===d.tags.length?!0:t.tags.intersects(d.tags),c&&h(l,d)};this.onLoad=function(t){c(t,a.LOADED)},this.onError=function(t){c(t,a.ERROR)},this.onTimeout=function(t){c(t,a.TIMEOUT)};var h=function(t,n){var e,i,r,s,u=0,d=0;for(e=0,i=o.length;i>e;e++)r=o[e],s=!1,s=0===n.tags.length?!0:r.resource.tags.intersects(n.tags),s&&(d++,(r.status===a.LOADED||r.status===a.ERROR||r.status===a.TIMEOUT)&&u++);n.callback({resource:t.resource,loaded:t.status===a.LOADED,error:t.status===a.ERROR,timeout:t.status===a.TIMEOUT,completedCount:u,totalCount:d})},l=this.log=function(t){if(window.console){var e=Math.round((Date.now()-n)/1e3);window.console.log("PxLoader elapsed: "+e+" sec");for(var i=0,r=o.length;r>i;i++){var s=o[i];if(t||s.status===a.WAITING){var u="PxLoader: #"+i+" "+s.resource.getName();switch(s.status){case a.QUEUED:u+=" (Not Started)";break;case a.WAITING:u+=" (Waiting)";break;case a.LOADED:u+=" (Loaded)";break;case a.ERROR:u+=" (Error)";break;case a.TIMEOUT:u+=" (Timeout)"}s.resource.tags.length>0&&(u+=" Tags: ["+s.resource.tags.all.join(",")+"]"),window.console.log(u)}}}}}function e(t){if(this.all=[],this.first=null,this.length=0,this.lookup={},t){if(Array.isArray(t))this.all=t.slice(0);else if("object"==typeof t)for(var n in t)t.hasOwnProperty(n)&&this.all.push(n);else this.all.push(t);this.length=this.all.length,this.length>0&&(this.first=this.all[0]);for(var e=0;e<this.length;e++)this.lookup[this.all[e]]=!0}}e.prototype.intersects=function(t){if(0===this.length||0===t.length)return!1;if(1===this.length&&1===t.length)return this.first===t.first;if(t.length<this.length)return t.intersects(this);for(var n in this.lookup)if(t.lookup[n])return!0;return!1},"function"==typeof define&&define.amd&&define("PxLoader",[],function(){return n}),t.PxLoader=n}(this),Date.now||(Date.now=function(){return(new Date).getTime()}),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),PxLoader.prototype.addImage=function(t,n,e,o){var i=new PxLoaderImage(t,n,e,o);return this.add(i),i.img},"function"==typeof define&&define.amd&&define("PxLoaderImage",[],function(){return PxLoaderImage}),PxLoader.prototype.addSound=function(t,n,e,o){var i=new PxLoaderSound(t,n,e,o);return this.add(i),i.sound},"function"==typeof define&&define.amd&&define("PxLoaderSound",[],function(){return PxLoaderSound}),PxLoader.prototype.addVideo=function(t,n,e,o){var i=new PxLoaderVideo(t,n,e,o);return this.add(i),i.vid},"function"==typeof define&&define.amd&&define("PxLoaderVideo",[],function(){return PxLoaderVideo});var PxLoaderData=function(t,n,e){var o=this,i=null;this.tags=n,this.priority=e,this.request=new XMLHttpRequest,this.start=function(n){i=n,o.request.onload=this.onLoad,o.request.onerror=this.onError,o.request.open("GET",t,!0),o.request.send(null)},this.checkStatus=function(){200===o.request.status&&i.onLoad(o)},this.onTimeout=function(){200===o.request.status?i.onLoad(o):i.onTimeout(o)},this.onLoad=function(){i.onLoad(o)},this.onError=function(){i.onError(o)},this.getName=function(){return t}};PxLoader.prototype.addData=function(t,n,e){var o=new PxLoaderData(t,n,e);return this.add(o),o.request},"function"==typeof define&&define.amd&&define("PxLoaderData",[],function(){return PxLoaderData});